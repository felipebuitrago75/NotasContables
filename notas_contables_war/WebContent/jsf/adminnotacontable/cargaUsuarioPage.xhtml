<?xml version="1.0" encoding="ISO-8859-1"?>

<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core" xmlns:a4j="http://richfaces.org/a4j" xmlns:rich="http://richfaces.org/rich"
	template="../../common/template.xhtml">
	<ui:param name="title" value="Carga de Instancias por Usuario" />
	<ui:define name="body">

		<!--Filtro de busqueda	-->
		<div style="width: 990px;"><h:panelGrid columns="1" width="100%">
			<h1 align="center">Carga de Instancias por Usuario</h1>
		</h:panelGrid> 
		<!-- Panel de opciones --> 
		<!-- Campos del formulario --> 
		<h:panelGrid id="informacion" columns="1" width="60%" cellpadding="0" cellspacing="0">
			<rich:simpleTogglePanel label="Filtro de búsqueda" width="100%" opened="#{empty cargaUsuarioPage.datos}" switchType="client">
				<h:panelGrid columns="2" width="100%" cellpadding="0" cellspacing="5">
					<h:outputText value="Sucursal Origen" />
					<h:selectOneMenu value="#{cargaUsuarioPage.sucursal}" immediate="true">
						<f:selectItems value="#{cargaUsuarioPage.sucursales}" />
					</h:selectOneMenu>
					<h:outputText value="Rol" />
					<h:selectOneMenu value="#{cargaUsuarioPage.rol}" immediate="true" converter="javax.faces.Integer">
						<f:selectItems value="#{cargaUsuarioPage.roles}" />
					</h:selectOneMenu>
					<h:outputText value="Estado" />
					<h:selectOneMenu value="#{cargaUsuarioPage.estado}" immediate="true" >
						<f:selectItem itemValue="0" itemLabel="Pendiente de aprobación por Subgenrente, Gerente, Área Central" />
						<f:selectItem itemValue="1" itemLabel="Pendiente de Revisión" />
						<f:selectItem itemValue="2" itemLabel="Pendiente de aprobación por Padrino - Unidad de Análisis" />
						<f:selectItem itemValue="3" itemLabel="Pendiente de aprobación ente Autorizador" />
						<f:selectItem itemValue="4" itemLabel="Precierre" />
					</h:selectOneMenu>
				</h:panelGrid>
				<h:panelGrid columns="1" styleClass="center">
					<a4j:commandButton action="#{cargaUsuarioPage.buscar}" reRender="informacion,lista" value="Buscar" />
				</h:panelGrid>
			</rich:simpleTogglePanel>
		</h:panelGrid> 
		
		<ui:include src="../../common/mensajes.xhtml" /> 
		
		<!-- Tabla de registros --> 
		
		<h:panelGrid columns="1" width="100%" style="align:center;" id="lista">

			<rich:dataTable value="#{cargaUsuarioPage.datos}" var="dato" id="table" rows="15" rendered="#{! empty cargaUsuarioPage.datos}" rowKeyVar="rowKey" width="100%" footerClass="row2" onRowMouseOver="this.style.backgroundColor='#9fbdeb'"
				onRowMouseOut="this.style.backgroundColor='#{a4jSkin.rowBackgroundColor}'" rowClasses="row1, row2">
				<f:facet name="header">
					<rich:datascroller fastControls="false" pageIndexVar="pageIndex" pagesVar="pages" style="color:black;" for="table" maxPages="5" renderIfSinglePage="false" page="#{cargaUsuarioPage.scrollPage}" id="up" reRender="lista, filtro"
						limitToList="true" ajaxSingle="true">
					</rich:datascroller>
				</f:facet>

				<rich:column sortable="true" sortBy="#{dato.usuarioModulo.codigoAreaModificado}">
					<f:facet name="header"><h:outputText value="Área" /></f:facet>
					<h:panelGrid columns="2">
						<h:outputText value="#{dato.usuarioModulo.codigoAreaModificado}" />
						<h:outputText value="#{dato.usuarioModulo.nombreAreaModificado}" />
					</h:panelGrid>
				</rich:column>
				<rich:column sortable="true" sortBy="#{dato.usuarioModulo.codigoEmpleado}">
					<f:facet name="header"><h:outputText value="Usuario" /></f:facet>
					<h:outputText value="#{dato.usuarioModulo.codigoEmpleado}" />
				</rich:column>
				<rich:column sortable="true" sortBy="#{dato.usuarioModulo.rol.nombre}">
					<f:facet name="header"><h:outputText value="Rol" /></f:facet>
					<h:outputText value="#{dato.usuarioModulo.rol.nombre}" />
				</rich:column>
				<rich:column sortable="true" sortBy="#{dato.cantInstancias}">
					<f:facet name="header"><h:panelGroup><h:outputText value="Instancias" /><br/><h:outputText value="Asignadas" /></h:panelGroup></f:facet>
					<h:outputText value="#{dato.cantInstancias}" />
				</rich:column>

				<f:facet name="footer">
					<rich:datascroller style="color:black;" align="center" for="table" page="#{cargaUsuarioPage.scrollPage}" boundaryControls="hide" fastControls="hide" stepControls="hide" renderIfSinglePage="true">
						<f:facet name="pages">
							<h:outputText value="Visualizando del #{((pageIndex-1)*15)+1 } al #{(pages!=pageIndex)?(pageIndex*15):cargaUsuarioPage.totalFilas} de un total de #{cargaUsuarioPage.totalFilas} registros." />
						</f:facet>
					</rich:datascroller>
				</f:facet>
			</rich:dataTable>
		</h:panelGrid></div>
	</ui:define>
</ui:composition>
